<div class='control button' class:active on:click="setState(apiId,!active)">
    <svelte:component this="{icons[icon]}"/>
</div>

<script>
  import icons from './icons';
  import store from './stores/AppDataStore.js';
  import { setOutputState } from './rest/OctoConnection.js';
  import { runJob } from './stores/StoreManager.js'

  export default {
    data: () => ({
      icons
    }),
    store: () => store,
    computed: {
      active({$outputStates, apiId}) {
        const state = $outputStates.find( state => state.index_id === apiId );
        return state ? state.status : false;
      }
    },
    methods: {
      setState(apiId,state) {
        setOutputState(apiId,state)
          .then(() => runJob('outputStates'));
      }
    }
  }
</script>