<div id="power-bar">
  <PowerButton bind:power=$lightPower icon={lightBulbIcon}/>
  <PowerButton bind:power=$fanPower icon={fanIcon}/>
  <PowerButton bind:power=$printerPower icon={printerIcon}/>
  <PowerButton bind:power=skullPower icon={skullIcon}/>
</div>
    
<script>
  import PowerButton from './PowerButton.html';
  import LightBulbIcon from './icons/LightBulbIcon.html';
  import FanIcon from './icons/FanIcon.html';
  import PrinterIcon from './icons/PrinterIcon.html';
  import SkullIcon from './icons/SkullIcon.html';
  import { Store } from 'svelte/store.js';

  const store = new Store({
    lightPower: "off",
    fanPower: "off",
    printerPower: "on",
  });

  export default {
    components: { PowerButton },
    store: () => store,
    data() {
      return {
        lightBulbIcon: LightBulbIcon,
        fanIcon: FanIcon,
        printerIcon: PrinterIcon,
        skullIcon: SkullIcon,
        skullPower: "off"
      }
    },
    onstate({changed}) {
      if(changed.skullPower === true) {
        store.set({
          lightPower: "off",
          fanPower: "off",
          printerPower: "off"
        });
        this.set({skullPower:"off"});
      }
    }
  };
</script>      