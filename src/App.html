<div id=app>
  <Cube/>
  {#if $state == 'Error'}
    <div id=error>
      Octoprint is not accessible at {host}
    </div>
  {/if}

  {#if $state == 'Connected'}
    {#if powerButtons}
      <PowerBar/>
    {/if}
    <PrinterConnection/>
  {/if}
</div>

<style>
  #app {
    position: fixed;
    width: 100%;
    height: 100%; 
    top: 0;
    left: 0;
  }
  #error {
    bottom: 0;
    position: absolute;
    font-size: 3em;
    color: rgb(83, 17, 17);
  }
</style>

<script>
  import conf from '../conf.json';
  import store from './stores/ApiConnectionStateStore.js'

  export default {
    components: { 
      PowerBar: './PowerBar.html', 
      Cube: './Cube.html',
      PrinterConnection: './PrinterConnection.html',
    },
    store: () => store,
    data: () => ({
      powerButtons: conf.powerButtons,
      host: conf.host
    }),
    oncreate() {
      store.start();
    },
    ondestroy() {
      store.stop();
    }
  }
</script>

